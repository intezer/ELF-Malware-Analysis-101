import "elf"

rule compiled_with_pyinstaller
{
    meta:
	decription = "this rule detects ELF files that were compiled with pyinstaller - https://www.pyinstaller.org/"
    strings:
        $str1 = "Error detected starting Python VM."
    condition:
        for any i in (0..elf.number_of_sections) : (elf.sections[i].name == "pydata") and $str1
}

rule compiled_with_shc
{
    meta:
    	decription = "this rule detects ELF files that were compiled with shc - shell script compiler https://github.com/neurobin/shc"
    strings:
         $str1 = "%lu %d%c"
         $str = "=%lu %d"
         $str3 = "%s%s%s: %s"

  condition:
        all of them
}
